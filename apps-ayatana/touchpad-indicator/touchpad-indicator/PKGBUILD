# Maintainer: György Balló <ballogy@freestart.hu>
pkgname=touchpad-indicator
pkgver=0.9.1.6
pkgrel=1
_pkgrel=1ubuntu1
pkgdesc="An indicator to show the status of the touchpad, and to enable and disable the touchpad"
arch=('any')
url="https://launchpad.net/touchpad-indicator"
license=('GPL')
depends=('dbus-python' 'python2-gobject' 'libappindicator3' 'libnotify' 'python2-udev' 'python-xlib' 'xorg-xinput' 'xorg-xmodmap' 'dconf' 'hicolor-icon-theme' 'xdg-utils')
install=$pkgname.install
source=(https://launchpad.net/~atareao/+archive/atareao/+files/${pkgname}_$pkgver-$_pkgrel.tar.gz)
md5sums=('62e8a22c94c756eaa82d51e66d54dab6')

build() {
  cd "$srcdir/touchpad-indicator"

  sed -i 's@^#!.*python$@#!/usr/bin/python2@' src/*.py
  sed -i "s|LANGDIR =.*|LANGDIR = '/usr/share/locale'|" src/com.py
  sed -i 's/lsb_release -a/uname -sr/' src/machine_information.py
}

package() {
  cd "$srcdir/touchpad-indicator"

  # Build the sctructure
  mkdir -p "$pkgdir"/usr/{bin,share/{touchpad-indicator,applications,glib-2.0/schemas,icons/hicolor/24x24/status,pixmaps}}
  mkdir -p "$pkgdir"/usr/share/locale/{en,fr,lt,de,it,zh_CN,fi,ru,gl,es,pl,ka,id,ca,tr,cs,nl,pt_BR,en_GB,eu,sk,ja,vi,uk,zh_TW,sr,sv}/LC_MESSAGES

  # Copy files
  cp bin/* "$pkgdir/usr/bin"
  cp src/* "$pkgdir/usr/share/touchpad-indicator"
  cp data/Touchpad-Indicator.desktop "$pkgdir/usr/share/applications"
  cp data/touchpad-indicator-autostart.desktop "$pkgdir/usr/share/touchpad-indicator"
  cp data/apps.indicators.touchpad-indicator.gschema.xml "$pkgdir/usr/share/glib-2.0/schemas"
  cp data/icons/*.svg "$pkgdir/usr/share/icons/hicolor/24x24/status"
  cp data/icons/touchpad-indicator.svg "$pkgdir/usr/share/pixmaps"

  # Make language files
  msgfmt template1/en.po -o "$pkgdir/usr/share/locale/en/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/fr.po -o "$pkgdir/usr/share/locale/fr/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/lt.po -o "$pkgdir/usr/share/locale/lt/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/de.po -o "$pkgdir/usr/share/locale/de/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/it.po -o "$pkgdir/usr/share/locale/it/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/zh_CN.po -o "$pkgdir/usr/share/locale/zh_CN/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/fi.po -o "$pkgdir/usr/share/locale/fi/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/ru.po -o "$pkgdir/usr/share/locale/ru/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/gl.po -o "$pkgdir/usr/share/locale/gl/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/es.po -o "$pkgdir/usr/share/locale/es/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/pl.po -o "$pkgdir/usr/share/locale/pl/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/ka.po -o "$pkgdir/usr/share/locale/ka/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/id.po -o "$pkgdir/usr/share/locale/id/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/ca.po -o "$pkgdir/usr/share/locale/ca/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/tr.po -o "$pkgdir/usr/share/locale/tr/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/cs.po -o "$pkgdir/usr/share/locale/cs/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/nl.po -o "$pkgdir/usr/share/locale/nl/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/pt_BR.po -o "$pkgdir/usr/share/locale/pt_BR/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/en_GB.po -o "$pkgdir/usr/share/locale/en_GB/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/eu.po -o "$pkgdir/usr/share/locale/eu/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/sk.po -o "$pkgdir/usr/share/locale/sk/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/ja.po -o "$pkgdir/usr/share/locale/ja/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/vi.po -o "$pkgdir/usr/share/locale/vi/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/uk.po -o "$pkgdir/usr/share/locale/uk/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/zh_TW.po -o "$pkgdir/usr/share/locale/zh_TW/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/sr.po -o "$pkgdir/usr/share/locale/sr/LC_MESSAGES/touchpad-indicator.mo"
  msgfmt template1/sv.po -o "$pkgdir/usr/share/locale/sv/LC_MESSAGES/touchpad-indicator.mo"
}
