# Maintainer: D. Can Celasun <dcelasun[at]gmail[dot]com>
# Contributor: Madek <gonzaloseguel@gmail.com>

pkgname=indicator-workspaces
pkgver=0.6.2.2
pkgrel=1
arch=(any)
pkgdesc="Provides a replacement for panel applet switcher"
url="https://launchpad.net/indicator-workspaces"
license=(GPL)
depends=(libappindicator python2-gconf python-wnck)
install=$pkgname.install
source=(https://launchpad.net/~geod/+archive/ppa-geod/+files/${pkgname}_$pkgver.tar.gz)
md5sums=(7faf427362f7bcfd9f51a700507c5853)

build() {
  cd "$srcdir/$pkgname-$pkgver"
  sed -i 's@^#!.*python$@#!/usr/bin/python2@' indicator-workspaces{,-preferences}
}

package() {
  cd "$srcdir/$pkgname-$pkgver"

  export DESTDIR=$pkgdir/usr
  export SHAREDIR=$DESTDIR/share/indicator-workspaces
  export DATADIR=$DESTDIR/share/icons
  export BINDIR=$DESTDIR/bin
  export MENUDIR=$DESTDIR/share/applications
  export STARTDIR=$pkgdir/etc/xdg/autostart
  export GCONFDIR=$DESTDIR/share/gconf/schemas

  install -Dm644 share/workspaces-preferences.glade $SHAREDIR/workspaces-preferences.glade
  install -Dm644 share/indicator-workspaces.schemas $SHAREDIR/indicator-workspaces.schemas
  install -Dm644 share/indicator-workspaces-preferences.desktop $MENUDIR/indicator-workspaces-preferences.desktop
  install -Dm644 share/indicator-workspaces.desktop $STARTDIR/indicator-workspaces.desktop
  install -dm755 $DATADIR/{ubuntu-mono-dark,ubuntu-mono-light}/status/24
  install -Dm644 share/ubuntu-mono-dark/status/24/* $DATADIR/ubuntu-mono-dark/status/24
  install -Dm644 share/ubuntu-mono-light/status/24/* $DATADIR/ubuntu-mono-light/status/24
  install -Dm755 indicator-workspaces $BINDIR/indicator-workspaces
  install -Dm755 indicator-workspaces-preferences $BINDIR/indicator-workspaces-preferences
  install -Dm755 share/indicator-workspaces.schemas $GCONFDIR/indicator-workspaces.schemas

  # Install autostart file
#  install -Dm644 "$srcdir/$pkgname.desktop" "$pkgdir/etc/xdg/autostart/$pkgname.desktop"
}
